<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a list of data frames containing tracking informations and including the value of turning angles,
distance traveled and activity states (either 1 or 0 for active or inactive state respectively), this function compute the mean square displacement value
corresponding to a measure of the deviation of a particle's position according to a reference position over time. Computation can be performed
through the use of the equations derived from Kareiva &amp;amp; Shigesada (1983) or Turchin (2015). In a nutshell the Turchin's equation for MSD is a simplified version of the
Kareiva &amp;amp; Shigesada' equation, assuming symmetric turning angles."><title>Compute Mean Square Displacement (MSD). — MSD • MoveR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.6/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Compute Mean Square Displacement (MSD). — MSD"><meta property="og:description" content="Given a list of data frames containing tracking informations and including the value of turning angles,
distance traveled and activity states (either 1 or 0 for active or inactive state respectively), this function compute the mean square displacement value
corresponding to a measure of the deviation of a particle's position according to a reference position over time. Computation can be performed
through the use of the equations derived from Kareiva &amp;amp; Shigesada (1983) or Turchin (2015). In a nutshell the Turchin's equation for MSD is a simplified version of the
Kareiva &amp;amp; Shigesada' equation, assuming symmetric turning angles."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MoveR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--how-to">
    <span class="fas fa fas fa-book"></span>
     
    How To
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--how-to">
    <a class="dropdown-item" href="../articles/MoveR-ImportData.html">Import Data</a>
    <a class="dropdown-item" href="../articles/MoveR-Clean-FilterData.html">Clean/Filter Data</a>
    <a class="dropdown-item" href="../articles/MoveR-ComputeMetrics.html">Compute some metrics</a>
    <a class="dropdown-item" href="../articles/MoveR-PatternId.html">Sequences identification</a>
    <a class="dropdown-item" href="../articles/MoveR-ParallelComputation.html">Parallel computing</a>
    <a class="dropdown-item" href="../articles/MoveR-SensitivityAnalysis.html">Detection performances</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fas fa fas fa-history"></span>
     
    Changelog
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/qpetitjean/MoveR/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Mean Square Displacement (MSD).</h1>
      <small class="dont-index">Source: <a href="https://github.com/qpetitjean/MoveR/blob/HEAD/R/MSD.R" class="external-link"><code>R/MSD.R</code></a></small>
      <div class="d-none name"><code>MSD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a list of data frames containing tracking informations and including the value of turning angles,
distance traveled and activity states (either 1 or 0 for active or inactive state respectively), this function compute the mean square displacement value
corresponding to a measure of the deviation of a particle's position according to a reference position over time. Computation can be performed
through the use of the equations derived from Kareiva &amp; Shigesada (1983) or Turchin (2015). In a nutshell the Turchin's equation for MSD is a simplified version of the
Kareiva &amp; Shigesada' equation, assuming symmetric turning angles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MSD</span><span class="op">(</span></span>
<span>  <span class="va">trackDat</span>,</span>
<span>  turnAngle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  distTraveled <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  activityStates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Turchin"</span>, <span class="st">"KS"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>trackDat</dt>
<dd><p>A list of data frame containing tracking informations for each tracklet.</p></dd>


<dt>turnAngle</dt>
<dd><p>A character string indicating the name of the variable specifying the turning angles over each trajectories.</p></dd>


<dt>distTraveled</dt>
<dd><p>A character string indicating the name of the variable specifying the distance traveled by the particles.</p></dd>


<dt>activityStates</dt>
<dd><p>A character string indicating the name of the variable specifying activity state (coded as 1 or 0 for active and inactive state, respectively).</p></dd>


<dt>method</dt>
<dd><p>A character string indicating the method used to compute the net square displacement, either "Turchin" or "KS" to use the computation derived from the equations of Turchin's book 2015 edition (corrected version of the chapter 5.3 from 1998) or from Kareiva &amp; Shigesada (1983) (default = "Turchin").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>this function returns the Mean Square Displacement (MSD) value according to the equations derived from Turchin (2015) or Kareiva &amp; Shigesada (1983).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Kareiva, P.M., Shigesada, N., (1983). Analyzing insect movement as correlated random walk. Oecologia 56,234–238. <a href="https://doi.org/10.1007/BF00379695" class="external-link">https://doi.org/10.1007/BF00379695</a></p></li>
<li><p>Turchin, P., (2015). Quantitative Analysis of Movement: Measuring and Modeling Population Redistribution in Animals and Plants. Beresta Books, Storrs, Connecticut.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Quentin PETITJEAN, Vincent CALCAGNO</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate a correlated random walk with known parameter to verify Turchin D computation</span></span></span>
<span class="r-in"><span><span class="co">## specify some parameters</span></span></span>
<span class="r-in"><span><span class="va">nn</span> <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">stepLength</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">angularErrorSd</span> <span class="op">=</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create a function to simulate correlated random walk</span></span></span>
<span class="r-in"><span><span class="va">myccrw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">disps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nn</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">stepLength</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">angulos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nn</span>, min <span class="op">=</span> <span class="op">-</span><span class="va">angularErrorSd</span>, max <span class="op">=</span> <span class="va">angularErrorSd</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lesx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nn</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lesy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nn</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">curangle</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, min <span class="op">=</span> <span class="op">-</span><span class="va">pi</span>, max <span class="op">=</span> <span class="va">pi</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">nn</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">curangle</span> <span class="op">=</span> <span class="va">curangle</span> <span class="op">+</span> <span class="va">angulos</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">lesx</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">lesx</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">curangle</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">lesy</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">lesy</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">curangle</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x.pos <span class="op">=</span> <span class="va">lesx</span> <span class="op">+</span> <span class="fl">250</span>,</span></span>
<span class="r-in"><span>    y.pos <span class="op">=</span> <span class="va">lesy</span> <span class="op">+</span> <span class="fl">250</span>,</span></span>
<span class="r-in"><span>    frame <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nn</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulated 30 tracklets</span></span></span>
<span class="r-in"><span><span class="va">nbr</span> <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="va">simus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nbr</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">rrr</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">myccrw</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take a look at the simulated data</span></span></span>
<span class="r-in"><span><span class="fu">MoveR</span><span class="fu">::</span><span class="fu"><a href="drawTracklets.html">drawTracklets</a></span><span class="op">(</span><span class="va">simus</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MSD-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Manually compute diffusion coefficient through time over all tracklets</span></span></span>
<span class="r-in"><span><span class="va">arda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nbr</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ff</span> <span class="op">=</span> <span class="va">simus</span><span class="op">[[</span><span class="va">t</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">mimi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ff</span><span class="op">$</span><span class="va">x.pos</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">(</span><span class="op">(</span><span class="va">ff</span><span class="op">$</span><span class="va">x.pos</span><span class="op">[</span><span class="va">d</span><span class="op">]</span> <span class="op">-</span> <span class="fl">250</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">ff</span><span class="op">$</span><span class="va">y.pos</span><span class="op">[</span><span class="va">d</span><span class="op">]</span> <span class="op">-</span> <span class="fl">250</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mimi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mimiz</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">arda</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nn</span>,</span></span>
<span class="r-in"><span>  <span class="va">mimiz</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Number of steps"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"mean MSD"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute the needed metrics on simulated tracklets</span></span></span>
<span class="r-in"><span><span class="va">simComp</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">MoveR</span><span class="fu">::</span><span class="fu"><a href="analyseTracklets.html">analyseTracklets</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">simus</span>,</span></span>
<span class="r-in"><span>    customFunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="co">## compute turning angle in radians over each tracklet (a modulus present within the MoveR package)</span></span></span>
<span class="r-in"><span>      turnAngle <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">MoveR</span><span class="fu">::</span><span class="fu"><a href="turnAngle.html">turnAngle</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="va">x</span>,</span></span>
<span class="r-in"><span>          timeCol <span class="op">=</span> <span class="st">"frame"</span>,</span></span>
<span class="r-in"><span>          unit <span class="op">=</span> <span class="st">"radians"</span>,</span></span>
<span class="r-in"><span>          scale <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>        <span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="co">## compute distance traveled</span></span></span>
<span class="r-in"><span>      distTraveled <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">MoveR</span><span class="fu">::</span><span class="fu"><a href="distTraveled.html">distTraveled</a></span><span class="op">(</span><span class="va">x</span>, step <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="co">## add behavioral states (consider as active all the time)</span></span></span>
<span class="r-in"><span>      activity <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">MSD</span> <span class="op">&lt;-</span> <span class="fu">MoveR</span><span class="fu">::</span><span class="fu">MSD</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">simComp</span>,</span></span>
<span class="r-in"><span>  turnAngle <span class="op">=</span> <span class="st">"turnAngle"</span>,</span></span>
<span class="r-in"><span>  distTraveled <span class="op">=</span> <span class="st">"distTraveled"</span>,</span></span>
<span class="r-in"><span>  activityStates <span class="op">=</span> <span class="st">"activity"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"Turchin"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># retrieve the total number of steps to add the computed MSD trend to the plot</span></span></span>
<span class="r-in"><span><span class="va">nsteps</span> <span class="op">&lt;-</span> <span class="va">nn</span> <span class="op">*</span> <span class="va">nbr</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">MSD</span><span class="op">/</span><span class="va">nsteps</span> , col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="MSD-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://qpetitjean.github.io/qpetitjean_distill/" class="external-link">Quentin PETITJEAN</a>, <a href="https://vcalcagnoresearch.wordpress.com/" class="external-link">Vincent CALCAGNO</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

