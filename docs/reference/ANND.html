<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a list of data frames containing tracking information for each tracklet (including the timeline)
this function returns the Average Nearest Neighbour Distance among tracklets along a specified timeline. Also,
if bootn parameter is above 0, the function compute studentize 95 % CI using bootstrapping method."><title>Compute Average Nearest Neighbour Distance (ANND) among tracklets. — ANND • MoveR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Roboto-0.4.0/font.css" rel="stylesheet"><link href="../deps/_JetBrains%20Mono-0.4.0/font.css" rel="stylesheet"><link href="../deps/_Roboto%20Slab-0.4.0/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Compute Average Nearest Neighbour Distance (ANND) among tracklets. — ANND"><meta property="og:description" content="Given a list of data frames containing tracking information for each tracklet (including the timeline)
this function returns the Average Nearest Neighbour Distance among tracklets along a specified timeline. Also,
if bootn parameter is above 0, the function compute studentize 95 % CI using bootstrapping method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MoveR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--how-to">
    <span class="fas fa fas fa-book"></span>
     
    How To
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--how-to">
    <a class="dropdown-item" href="../articles/MoveR-ImportData.html">Import Data</a>
    <a class="dropdown-item" href="../articles/MoveR-Clean-FilterData.html">Clean/Filter Data</a>
    <a class="dropdown-item" href="../articles/MoveR-ComputeMetrics.html">Compute some metrics</a>
    <a class="dropdown-item" href="../articles/MoveR-SensitivityAnalysis.html">Conduct Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/MoveR-ParallelComputation.html">Perform Parallel Computation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fas fa fas fa-history"></span>
     
    Changelog
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/qpetitjean/MoveR/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute Average Nearest Neighbour Distance (ANND) among tracklets.</h1>
      <small class="dont-index">Source: <a href="https://github.com/qpetitjean/MoveR/blob/HEAD/R/ANND.R" class="external-link"><code>R/ANND.R</code></a></small>
      <div class="d-none name"><code>ANND.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a list of data frames containing tracking information for each tracklet (including the timeline)
this function returns the Average Nearest Neighbour Distance among tracklets along a specified timeline. Also,
if bootn parameter is above 0, the function compute studentize 95 % CI using bootstrapping method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ANND</span><span class="op">(</span></span>
<span>  <span class="va">trackDat</span>,</span>
<span>  timeCol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Tinterval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sampling <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bootn <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>trackDat</dt>
<dd><p>A list of data frame containing tracking information for each tracklet (including a timeline).</p></dd>


<dt>timeCol</dt>
<dd><p>A character string corresponding to the name of the column containing Time information (e.g., "frame").</p></dd>


<dt>Tinterval</dt>
<dd><p>A vector containing two numeric values expressed in the timeline unit and
specifying the time window on which the computation is performed (default is null, meaning the computation will be performed on the whole timeline).</p></dd>


<dt>sampling</dt>
<dd><p>A numeric value expressed in the timeline unit and specifying the subsampling step used to
to perform the computation (it allow to make computation faster). In other words, it determine the resolution of the
returned results (e.g., a value of 5000 mean that values will be computed every 5000 time unit).</p></dd>


<dt>bootn</dt>
<dd><p>A numeric value corresponding to the number of bootstrap sampling used to compute studentize 95% confidence interval (default = 0, meaning bootstrap will be not performed).</p></dd>


<dt>progress</dt>
<dd><p>A logical value (i.e., TRUE or FALSE) indicating whether a progress bar should be displayed to inform process progression (default = TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>this function returns a list containing three elements:</p><ul><li><p>"ANND": a data frame containing 6 columns:
</p><ul><li><p>"ANNDmean": the averaged Nearest Neighbour Distance for each sampling step.</p></li>
<li><p>"97.5%": the upper limit of the confidence interval (97.5%).</p></li>
<li><p>"2.5%": the lower limit of the confidence interval (2.5%).</p></li>
<li><p>"ANNDsd": the standard deviation of the Average Nearest Neighbour Distance for each sampling step.</p></li>
<li><p>"nInd": the number of particules used to compute the Averaged Nearest Neighbour Distance for each sampling step.</p></li>
<li><p>"timeCol": the timeline according to timeCol and sampling arguments.</p></li>
</ul></li>
<li><p>"RawND": a list containing the raw neighbour distance computed among each particles across each time unit:
</p><ul><li><p>"timeCol_index": a list of vector corresponding to the tracklet identity containing the distance to each detected particles in the time unit.</p></li>
</ul></li>
<li><p>"BootSampling": a list of lists corresponding to each time unit sampled during the bootstrap and containing:
</p><ul><li><p>"sampledTracks": the identity of the tracklet sampled at each bootstrap iteration (the length of the list is equal to bootn argument).</p></li>
<li><p>"sampledValues": the nearest neighbour distance values for each sampled tracklet at each bootstrap iteration (the length of the list is equal to bootn argument).</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Quentin PETITJEAN</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># generate some dummy tracklets</span></span></span>
<span class="r-in"><span><span class="co">## start to specify some parameters to generate tracklets</span></span></span>
<span class="r-in"><span><span class="va">TrackN</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># the number of tracklet to simulate</span></span></span>
<span class="r-in"><span><span class="va">TrackL</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fl">100</span><span class="op">:</span><span class="fl">1000</span> <span class="co"># the length of the tracklets or a sequence to randomly sample tracklet length</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">TrackList</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">TrackN</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">trajr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/trajr/man/TrajGenerate.html" class="external-link">TrajGenerate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">TrackL</span>, <span class="fl">1</span><span class="op">)</span>, random <span class="op">=</span> <span class="cn">TRUE</span>, fps <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">id</span> <span class="op">&lt;&lt;-</span> <span class="va">id</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      x.pos <span class="op">=</span> <span class="va">j</span><span class="op">$</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">j</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      y.pos <span class="op">=</span> <span class="va">j</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">j</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      frame <span class="op">=</span> <span class="va">j</span><span class="op">$</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>      identity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Tracklet"</span>, <span class="va">id</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">TrackN</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute the ANND with a sampling of 100 time unit</span></span></span>
<span class="r-in"><span><span class="va">ANNDRes</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">MoveR</span><span class="fu">::</span><span class="fu">ANND</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">TrackList</span>,</span></span>
<span class="r-in"><span>    timeCol <span class="op">=</span> <span class="st">"frame"</span>,</span></span>
<span class="r-in"><span>    sampling <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    scale <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    bootn <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>for time unit = [988], only 1 or no tracklet detected, the returned neighbour distance is NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the results can be retrieved by accessing the "ANND" data frame</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	11 obs. of  6 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ANNDmean: num  22.3 22.1 23.4 23.1 28.1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ 97.5%   : num  15.4 16.1 17.2 16.6 19.9 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ 2.5%    : num  44.1 39.8 40 46.2 49.7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ANNDsd  : num  35.1 30.9 26.5 27.9 31.1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ nInd    : int  50 50 43 38 33 28 26 18 13 6 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ frame   : num  1 100 200 300 400 500 600 700 800 900 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># And hence you can plot it against the timeCol (here "frame")</span></span></span>
<span class="r-in"><span><span class="co">## remove the NA to avoid problem when plotting the confidence interval</span></span></span>
<span class="r-in"><span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ANNDmean</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ANNDmean</span> <span class="op">~</span> <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`2.5%`</span>, na.rm <span class="op">=</span> <span class="cn">T</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Time (frame)"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Average Nearest Neighbour Distance (ANND) and 95% CI"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`97.5%`</span> <span class="op">~</span> <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`2.5%`</span> <span class="op">~</span> <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`2.5%`</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`97.5%`</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  border <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is also possible to add the number of particles on which ANND was computed across time on the plot</span></span></span>
<span class="r-in"><span><span class="co"># here we can see that the less particles detected, the higher the ANND which make sense.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  yaxt <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">""</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">""</span>,</span></span>
<span class="r-in"><span>  axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span> <span class="cn">T</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>     at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> ,</span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span></span></span>
<span class="r-in"><span>                                                                       <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nInd</span> <span class="op">~</span> <span class="va">ANNDRes</span><span class="op">[[</span><span class="st">"ANND"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">frame</span>, col <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ANND-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://qpetitjean.github.io/qpetitjean_distill/" class="external-link">Quentin PETITJEAN</a>, <a href="https://vcalcagnoresearch.wordpress.com/" class="external-link">Vincent CALCAGNO</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

